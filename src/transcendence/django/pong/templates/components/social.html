{% load static i18n %}
{% block content %}

{% if user.is_authenticated %}
<div id="socialOffCanvas" class="offcanvas offcanvas-end" tabindex="-1" aria-labelledby="socialOffcanvasLabel">
  <div class="offcanvas-header">
    <h5 class="fs-3"><i class="bi bi-people-fill me-2"></i>Social</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <!-- Tabs -->
    <ul class="nav nav-tabs" id="socialTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="user-list-tab" data-bs-toggle="tab" data-bs-target="#user-list" type="button" role="tab" aria-controls="user-list" aria-selected="true">
          <i class="bi bi-people-fill"></i>
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tournament-tab" data-bs-toggle="tab" data-bs-target="#tournament" type="button" role="tab" aria-controls="tournament" aria-selected="false">
          <i class="bi bi-trophy"></i>
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="chat-tab" data-bs-toggle="tab" data-bs-target="#chat" type="button" role="tab" aria-controls="chat" aria-selected="false">
          <i class="bi bi-chat-dots"></i>
        </button>
      </li>
    </ul>
    <div class="tab-content" id="socialTabsContent">
      <!-- User List Tab -->
      <div class="tab-pane fade show active" id="user-list" role="tabpanel" aria-labelledby="user-list-tab">
        <table id="userTable" class="table">
          <tbody><!-- Table rows will be dynamically populated here --></tbody>
        </table>
      </div>
      <!-- Tournament Tab -->
      <div class="tab-pane fade" id="tournament" role="tabpanel" aria-labelledby="tournament-tab">
        <div id="tournamentContent"><!-- Tournament content will be dynamically populated here --></div>
      </div>
      <!-- Chat Tab -->
      <div class="tab-pane fade" id="chat" role="tabpanel" aria-labelledby="chat-tab">
        <div id="chatContent">
          <div class="container mt-4">
            <div class="row">
              <div class="col">
                <select id="userSelector" class="form-select mb-3" aria-label="Default select example">
                  <!-- Chat users will be dynamically populated here -->
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <div id="chatLog" class="border p-3 mb-3" style="height: 400px; max-height: 400px; overflow-y: auto;">
                  <!-- Chat log will be dynamically populated here -->
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <form id="send-message-form">
                  {% csrf_token %}
                  <input type="text" id="receiver" name="receiver" value="" hidden>
                  <input type="text" class="form-control" placeholder="{% trans 'Type a message...' %}" id="message" name="message" required>
                  <button class="btn btn-primary float-end mt-3" onclick="sendMessage(event)" id="send-button">{% trans "Send" %}</button>
              </div>
            </div>
          </div>
          <!-- Chat content will be dynamically populated here -->
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{% static 'pong/js/social.js' %}"></script>
<script src="{% static 'pong/js/chat.js' %}"></script>

{% include 'components/modals/userProfile.html' %}

{% endif %}
{% endblock %}